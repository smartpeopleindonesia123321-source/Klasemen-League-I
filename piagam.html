<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>PIAGAM PENGHARGAAN | FOOTBALL LEAGUE-I</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;700;900&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #d4af37; --silver: #aaa9ad; --bronze: #cd7f32;
            --dark: #0a0a0a; --white: #ffffff;
        }
        body { background: #222; font-family: 'Kanit', sans-serif; display: flex; flex-direction: column; align-items: center; gap: 50px; padding: 50px 0; }
        .certificate {
            width: 800px; height: 560px; background: var(--white);
            position: relative; border: 20px solid var(--dark);
            display: flex; flex-direction: column; align-items: center;
            box-shadow: 0 0 50px rgba(0,0,0,0.5); overflow: hidden; color: var(--dark);
            margin-bottom: 50px;
        }
        .inner-border { position: absolute; top: 15px; left: 15px; right: 15px; bottom: 15px; border: 2px solid var(--dark); pointer-events: none; }
        .corner { position: absolute; width: 100px; height: 100px; border: 8px solid var(--gold); }
        .top-left { top: 0; left: 0; border-right: none; border-bottom: none; }
        .top-right { top: 0; right: 0; border-left: none; border-bottom: none; }
        .bottom-left { bottom: 0; left: 0; border-right: none; border-top: none; }
        .bottom-right { bottom: 0; right: 0; border-left: none; border-top: none; }
        .header { margin-top: 60px; text-transform: uppercase; letter-spacing: 5px; font-weight: 400; font-size: 14px; }
        .award-title { font-family: 'Playfair Display', serif; font-size: 45px; margin: 10px 0; color: var(--gold); text-transform: uppercase; text-align: center;}
        .presented-to { margin-top: 20px; font-size: 16px; font-style: italic; }
        .winner-name { font-size: 40px; font-weight: 900; text-decoration: underline; margin: 5px 0; text-transform: uppercase; color: #111; }
        .league-name { font-weight: bold; color: #1e40af; margin-top: 10px; font-size: 20px; }
        .description { width: 80%; text-align: center; font-size: 14px; margin-top: 20px; line-height: 1.6; }
        .footer { margin-top: 40px; display: flex; justify-content: space-around; width: 100%; }
        .sig-box { text-align: center; width: 200px; }
        .sig-line { border-top: 2px solid var(--dark); margin-top: 50px; padding-top: 5px; font-weight: bold; }
        
        /* Variasi Warna */
        .cert-juara2 .award-title { color: var(--silver); } .cert-juara2 .corner { border-color: var(--silver); }
        .cert-juara3 .award-title { color: var(--bronze); } .cert-juara3 .corner { border-color: var(--bronze); }
        .cert-topscorer .award-title { color: #cc0000; } .cert-topscorer .corner { border-color: #cc0000; }
        .cert-poty .award-title { color: #1e40af; } .cert-poty .corner { border-color: #1e40af; }

        @media print { body { background: none; padding: 0; } .certificate { box-shadow: none; page-break-after: always; } button { display: none; } }
    </style>
</head>
<body>

    <div id="loading" style="color: white;">MENGUMPULKAN DATA PEMENANG...</div>
    <div id="certificates-container"></div>

    <script>
        const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ4v_ziMtwhRpQxS5ZnIbO9olIrUlzAAx8X5kS_Yr-Mv_GqDqSsg4Lc-1YNugRqElvUClbXnsf5gu12/pub?gid=0&single=true&output=csv';

        async function generateCertificates() {
            try {
                const res = await fetch(`${sheetUrl}&nocache=${new Date().getTime()}`);
                const csv = await res.text();
                let players = csv.split('\n').slice(1).map(line => {
                    const row = line.split(',').map(c => c.trim().replace(/"/g, ''));
                    return { nama: row[0], point: parseInt(row[1]) || 0, goals: parseInt(row[2]) || 0 };
                }).filter(p => p.nama);

                // Sorting buat nentukan pemenang
                const rankWinners = [...players].sort((a, b) => b.point - a.point || b.goals - a.goals);
                const scorerWinners = [...players].sort((a, b) => b.goals - a.goals);

                const dataPemenang = [
                    { type: 'cert-juara1', title: '1st PLACE CHAMPION', name: rankWinners[0].nama, desc: 'Atas prestasi luar biasa menjadi pemuncak klasemen akhir musim 2025/2026.' },
                    { type: 'cert-juara2', title: '2nd PLACE RUNNER UP', name: rankWinners[1].nama, desc: 'Atas perjuangan luar biasa meraih posisi kedua pada musim 2025/2026.' },
                    { type: 'cert-juara3', title: '3rd PLACE WINNER', name: rankWinners[2].nama, desc: 'Atas keberhasilan menempati posisi tiga besar pada kompetisi musim ini.' },
                    { type: 'cert-topscorer', title: 'GOLDEN BOOT (TOP SCORER)', name: scorerWinners[0].nama, desc: 'Dianugerahkan kepada pencetak gol terbanyak sepanjang kompetisi bergulir.' },
                    { type: 'cert-poty', title: 'PLAYER OF THE YEAR', name: rankWinners[0].nama, desc: 'Pemain terbaik dengan kontribusi dan konsistensi paling tinggi musim ini.' }
                ];

                const container = document.getElementById('certificates-container');
                document.getElementById('loading').style.display = 'none';

                dataPemenang.forEach(cert => {
                    container.innerHTML += `
                        <div class="certificate ${cert.type}">
                            <div class="inner-border"></div>
                            <div class="corner top-left"></div><div class="corner top-right"></div>
                            <div class="corner bottom-left"></div><div class="corner bottom-right"></div>
                            <div class="header">Official Achievement</div>
                            <div class="award-title">${cert.title}</div>
                            <div class="presented-to">Diberikan Kepada:</div>
                            <div class="winner-name">${cert.name}</div>
                            <div class="league-name">FOOTBALL LEAGUE-I</div>
                            <div class="description">${cert.desc}</div>
                            <div class="footer">
                                <div class="sig-box"><div class="sig-line">Official Admin</div></div>
                                <div class="sig-box"><div class="sig-line">League Manager</div></div>
                            </div>
                        </div>
                    `;
                });
            } catch (e) { console.error(e); }
        }
        generateCertificates();
    </script>
</body>
</html>
